<?xml version="1.0" encoding="UTF-8"?>
<table xmlns="http://query.yahooapis.com/v1/schema/table.xsd">
	<meta>
		<author>Erik Eldridge</author>
		<sampleQuery>select * from oauth where uri='http://example.com' and consumerKey='asd123' and consumerSecret='zxc456' and callbackUri='http://example.com';</sampleQuery>
		<documentationURL>http://wiki.github.com/erikeldridge/yql-oauth-support/</documentationURL>
	</meta>
	<bindings>
		<select itemPath="" produces="XML">
			<inputs>
				<key id="token" type="xs:string" paramType="variable"/>
				<key id="tokenSecret" type="xs:string" paramType="variable"/>
				<key id="content" type="xs:string" paramType="variable"/>
			</inputs>
			<execute><![CDATA[
			
			y.include( "http://github.com/yql/yql-tables/raw/master/oauth/oauth.utils.js" );
			
			//http://github.com/kvz/phpjs/raw/master/functions/url/parse_url.js
			y.include( 'store://O5Xv7RpWAXsyE9TqBe4NCk' );
			var uri = "http://api.douban.com/miniblog/saying";
			var parsed = parse_url( uri );
			var accessor = {
				consumerKey: "0995b7113482fff31cc125339d88ffd9",
				consumerSecret: "441cbd9231518ada",
				token: token,
				tokenSecret: tokenSecret,
				realm: parsed['scheme'] + '://' + parsed['host']
			};
			var args = {
				method: "POST",
				accessor: accessor,
				parameters:[]
			};
			if(content) {
				args.parameters.push( [ "content", content ] );
			}
			
			var request = y.rest( uri );
			response.object = sendRequest( args );
      ]]></execute>
		</select>
	</bindings>
</table>